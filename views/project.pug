extends base

block content
    .projectview
        //- récupère le status du projet, le met en minuscule et enlève les espaces pour l'ajouter en classe
        - let statuscolor = project.status.toLowerCase().trim().split(' ').join('')
        //- récupère la date du jour pour l'encadré des nouvelles factures
        - let date = new Date(Date.now()).toLocaleString('fr-FR', {day: 'numeric', month: 'long', year: 'numeric'});

        include _sidebar
        
        //- fenêtre modale pour créer une nouvelle facture
        include _newBill

        .project
            .project__header 
                h1 Project Details

            div(class=`card ${statuscolor}`)
                div(class=`card__header ${statuscolor}`)
                    p= `${project.name} `
                    p= `${project.date.toLocaleString('fr-FR', {day: 'numeric', month: 'long', year: 'numeric'})}`

                .card__details 
                    ul
                        div
                            li 
                                strong N° devis: 
                                |  #{project.quoteNumber }
                            li
                                strong Devis: 
                                |  #{project.quote}

                        div
                            li
                                strong Client 
                                |  #{project.client}
                            li 
                                strong Type de projet: 
                                |  #{project.projectType}

                        div
                            li
                                strong Nombre de factures: 
                                |  #{project.billsQuantity}
                            li 
                                strong Montant total factures: 
                                |  #{project.billsTotal}
                        div
                            li  
                                strong Statut : 
                                |  #{project.status}
                            li
                                strong Règlement: 
                                |  #{project.alreadyPaid}


                    a(href=`/project/${project._id}/edit`)
                                img(src='/img/edit.png')

            .billsHeader
                h1 Factures
                img#newBillButton(src='/img/add.png')

            each bill in project.bills
                - let billcolor = bill.state === 'Réglé' ? 'terminé' : 'proposition';

                div(class=`card ${billcolor}`)
                    div(class=`card__header ${billcolor}`)
                        p= `${bill.billName} `
                        p= `${bill.createdAt.toLocaleString('fr-FR', {day: 'numeric', month: 'long', year: 'numeric'})}`

                    .card__details 
                        ul
                            li.billPolish 
                                strong N° facture: 
                                |  #{bill.billNumber }
                            li.billPolish 
                                strong Montant facture: 
                                |  #{bill.price}
                            li.billPolish 
                                strong #{bill.state}

                        img(src='/img/edit.png')



            

            

